{
  "version": 3,
  "sources": ["../../../src/controllers/Auth/index.ts"],
  "sourcesContent": ["import { AuthService } from \"../../services/Auth\";\r\nimport { AuthRepository } from \"../../repositories/Auth\";\r\nimport { Request, Response } from \"express-serve-static-core\";\r\nimport { ParsedQs } from \"qs\";\r\nimport { logger } from \"../../helpers/Log\";\r\nimport ErrorFormatter from \"../../helpers/Response/ErrorFormatter\";\r\nimport SuccessSingularFormatter from '../../helpers/Response/SuccessSingularFormatter';\r\nimport FailFormatter from '../../helpers/Response/FailFormatter';\r\nimport { Login  as LoginRequest } from '../../domains/web/Login';\r\nimport { ValidationException, Validator } from '../../helpers/Validator';\r\nimport ErrorInputFormatter from \"../../helpers/Response/ErrorInputFormatter\";\r\nimport { BadRequestError } from \"../../helpers/Error/BadRequestError\";\r\n\r\n\r\n\r\nexport class Auth {\r\n    authService: AuthService\r\n\r\n    constructor(authService: AuthService, authRepository: AuthRepository){\r\n        this.authService = new AuthService(authRepository)\r\n    }\r\n\r\n\r\n    \r\n    async signInController(req: Request, res: Response) {\r\n      try {\r\n        const data: LoginRequest = req.body as LoginRequest;\r\n        const validatedData = Validator.validate(data, LoginRequest.getSchema());\r\n    \r\n        const result = await this.authService.SignInService(validatedData);\r\n        const response = SuccessSingularFormatter('Berhasil Login', { token: result });\r\n\r\n        res.status(200).send(response);\r\n\r\n      } catch (error: any) {\r\n          if (error instanceof ValidationException) {\r\n            const formattedErrors = error.errors.map((err) => ({ error: err.error, message: err.message }));\r\n            const response =  (formattedErrors)\r\n            \r\n            res.status(422).send(response);\r\n\r\n          }else if (error instanceof BadRequestError){\r\n\r\n            const formattedErrors = error.errors.map((err) => ({ error: err.error, message: err.message }));\r\n            const response = ErrorInputFormatter(formattedErrors)\r\n            \r\n            res.status(400).send(response);\r\n\r\n          }else {\r\n            const response = ErrorFormatter(error)\r\n            logger.error(error)\r\n            res.status(500).send(response)\r\n          }\r\n      \r\n    } \r\n      \r\n    }\r\n}"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAA4B;AAI5B,iBAAuB;AACvB,4BAA2B;AAC3B,sCAAqC;AAErC,mBAAuC;AACvC,uBAA+C;AAC/C,iCAAgC;AAChC,6BAAgC;AAIzB,MAAM,KAAK;AAAA,EACd;AAAA,EAEA,YAAY,aAA0B,gBAA+B;AACjE,SAAK,cAAc,IAAI,wBAAY,cAAc;AAAA,EACrD;AAAA,EAIA,MAAM,iBAAiB,KAAc,KAAe;AAClD,QAAI;AACF,YAAM,OAAqB,IAAI;AAC/B,YAAM,gBAAgB,2BAAU,SAAS,MAAM,aAAAA,MAAa,UAAU,CAAC;AAEvE,YAAM,SAAS,MAAM,KAAK,YAAY,cAAc,aAAa;AACjE,YAAM,eAAW,gCAAAC,SAAyB,kBAAkB,EAAE,OAAO,OAAO,CAAC;AAE7E,UAAI,OAAO,GAAG,EAAE,KAAK,QAAQ;AAAA,IAE/B,SAAS,OAAY;AACjB,UAAI,iBAAiB,sCAAqB;AACxC,cAAM,kBAAkB,MAAM,OAAO,IAAI,CAAC,SAAS,EAAE,OAAO,IAAI,OAAO,SAAS,IAAI,QAAQ,EAAE;AAC9F,cAAM,WAAa;AAEnB,YAAI,OAAO,GAAG,EAAE,KAAK,QAAQ;AAAA,MAE/B,WAAU,iBAAiB,wCAAgB;AAEzC,cAAM,kBAAkB,MAAM,OAAO,IAAI,CAAC,SAAS,EAAE,OAAO,IAAI,OAAO,SAAS,IAAI,QAAQ,EAAE;AAC9F,cAAM,eAAW,2BAAAC,SAAoB,eAAe;AAEpD,YAAI,OAAO,GAAG,EAAE,KAAK,QAAQ;AAAA,MAE/B,OAAM;AACJ,cAAM,eAAW,sBAAAC,SAAe,KAAK;AACrC,0BAAO,MAAM,KAAK;AAClB,YAAI,OAAO,GAAG,EAAE,KAAK,QAAQ;AAAA,MAC/B;AAAA,IAEN;AAAA,EAEA;AACJ;",
  "names": ["LoginRequest", "SuccessSingularFormatter", "ErrorInputFormatter", "ErrorFormatter"]
}
