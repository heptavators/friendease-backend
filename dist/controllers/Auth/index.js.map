{
  "version": 3,
  "sources": ["../../../src/controllers/Auth/index.ts"],
  "sourcesContent": ["import { AuthService } from \"../../services/Auth\";\r\nimport { Request, Response } from \"express-serve-static-core\";\r\nimport { logger } from \"../../helpers/Log\";\r\nimport ErrorFormatter from \"../../helpers/Response/ErrorFormatter\";\r\nimport SuccessSingularFormatter from '../../helpers/Response/SuccessSingularFormatter';\r\nimport { LoginRequest } from '../../domains/web/Login/LoginRequest';\r\nimport { ValidationException, Validator } from '../../helpers/Validator';\r\nimport { BadRequestError } from \"../../helpers/Error/BadRequestError\";\r\nimport { RegisterRequest } from \"../../domains/web/Login/RegisterRequest\";\r\n\r\nexport class AuthController {\r\n    authService: AuthService\r\n\r\n    constructor(authService: AuthService){\r\n        this.authService = authService\r\n    }\r\n\r\n    async LoginController(req: Request, res: Response) {\r\n      try {\r\n        const data = req.body as LoginRequest;\r\n        const validatedData = Validator.validate(data, LoginRequest.getSchema());\r\n        const result = await this.authService.SignInService(validatedData);\r\n\r\n        const response = SuccessSingularFormatter('Berhasil Login', { token: result });\r\n\r\n        return res.status(200).send(response);\r\n\r\n      } catch (error: any) {\r\n        handleErrorResponse(res, error)\r\n      } \r\n    }\r\n\r\n    async ProfileController(req: Request, res: Response) {\r\n      try {\r\n        const result = await this.authService.GetProfileService(req.authId);\r\n\r\n        const response = SuccessSingularFormatter('Profile User', result);\r\n\r\n        return res.status(200).send(response);\r\n\r\n      } catch (error: any) {\r\n        handleErrorResponse(res, error)\r\n      } \r\n    }\r\n\r\n\r\n    async RegisterController(req: Request, res: Response){\r\n      try {\r\n        const data = req.body as RegisterRequest;\r\n        const validatedData = Validator.validate(data, RegisterRequest.getSchema());\r\n        const result = await this.authService.RegisterService(validatedData);\r\n\r\n        const response = SuccessSingularFormatter('Berhasil Register Akun', result );\r\n\r\n        return res.status(200).send(response);\r\n\r\n      } catch (error) {\r\n        handleErrorResponse(res, error)\r\n      }\r\n    }\r\n  \r\n\r\n  }\r\n\r\n\r\n  \r\nconst handleErrorResponse = (res: Response, error: any) => {\r\n  if (error instanceof BadRequestError || error instanceof ValidationException) {\r\n    const response = ErrorFormatter(error.toResponseObject());\r\n    return res.status(error.status).send(response);\r\n  }\r\n\r\n  logger.error(error);\r\n  const response = ErrorFormatter(error);\r\n  return res.status(500).send(response);\r\n};\r\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA,iBAAuB;AACvB,4BAA2B;AAC3B,sCAAqC;AACrC,0BAA6B;AAC7B,uBAA+C;AAC/C,6BAAgC;AAChC,6BAAgC;AAEzB,MAAM,eAAe;AAAA,EACxB;AAAA,EAEA,YAAY,aAAyB;AACjC,SAAK,cAAc;AAAA,EACvB;AAAA,EAEA,MAAM,gBAAgB,KAAc,KAAe;AACjD,QAAI;AACF,YAAM,OAAO,IAAI;AACjB,YAAM,gBAAgB,2BAAU,SAAS,MAAM,iCAAa,UAAU,CAAC;AACvE,YAAM,SAAS,MAAM,KAAK,YAAY,cAAc,aAAa;AAEjE,YAAM,eAAW,gCAAAA,SAAyB,kBAAkB,EAAE,OAAO,OAAO,CAAC;AAE7E,aAAO,IAAI,OAAO,GAAG,EAAE,KAAK,QAAQ;AAAA,IAEtC,SAAS,OAAY;AACnB,0BAAoB,KAAK,KAAK;AAAA,IAChC;AAAA,EACF;AAAA,EAEA,MAAM,kBAAkB,KAAc,KAAe;AACnD,QAAI;AACF,YAAM,SAAS,MAAM,KAAK,YAAY,kBAAkB,IAAI,MAAM;AAElE,YAAM,eAAW,gCAAAA,SAAyB,gBAAgB,MAAM;AAEhE,aAAO,IAAI,OAAO,GAAG,EAAE,KAAK,QAAQ;AAAA,IAEtC,SAAS,OAAY;AACnB,0BAAoB,KAAK,KAAK;AAAA,IAChC;AAAA,EACF;AAAA,EAGA,MAAM,mBAAmB,KAAc,KAAc;AACnD,QAAI;AACF,YAAM,OAAO,IAAI;AACjB,YAAM,gBAAgB,2BAAU,SAAS,MAAM,uCAAgB,UAAU,CAAC;AAC1E,YAAM,SAAS,MAAM,KAAK,YAAY,gBAAgB,aAAa;AAEnE,YAAM,eAAW,gCAAAA,SAAyB,0BAA0B,MAAO;AAE3E,aAAO,IAAI,OAAO,GAAG,EAAE,KAAK,QAAQ;AAAA,IAEtC,SAAS,OAAO;AACd,0BAAoB,KAAK,KAAK;AAAA,IAChC;AAAA,EACF;AAGF;AAIF,MAAM,sBAAsB,CAAC,KAAe,UAAe;AACzD,MAAI,iBAAiB,0CAAmB,iBAAiB,sCAAqB;AAC5E,UAAMC,gBAAW,sBAAAC,SAAe,MAAM,iBAAiB,CAAC;AACxD,WAAO,IAAI,OAAO,MAAM,MAAM,EAAE,KAAKD,SAAQ;AAAA,EAC/C;AAEA,oBAAO,MAAM,KAAK;AAClB,QAAM,eAAW,sBAAAC,SAAe,KAAK;AACrC,SAAO,IAAI,OAAO,GAAG,EAAE,KAAK,QAAQ;AACtC;",
  "names": ["SuccessSingularFormatter", "response", "ErrorFormatter"]
}
